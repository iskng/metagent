# Metagent - Agent Workflow Distribution

Distributable agent workflows for autonomous coding. Install into any repository and keep prompts in sync.

## Quick Start

```bash
# Make metagent available globally
./metagent.sh link

# Install to current directory
metagent install

# Run bootstrap to configure
/bootstrap
```

## Commands

```bash
metagent install [path]      # Install agent to repo (default: current dir)
metagent sync [path]         # Sync prompts to repo (default: current dir)
metagent link                # Add metagent to PATH
metagent unlink              # Remove metagent from PATH
```

### Install Options

```bash
metagent install                     # Install to current dir
metagent install ~/projects/app      # Install to specific dir
metagent install -a code             # Specify agent (default: code)
metagent install --no-commands       # Skip slash command installation
```

### Sync Options

```bash
metagent sync                        # Sync current dir
metagent sync ~/projects/app         # Sync specific dir
metagent sync --all                  # Sync all tracked repos
metagent sync --dry-run              # Preview changes
metagent sync -a code                # Specify agent
```

### Other

```bash
metagent --list                      # List available agents
metagent --tracked                   # List tracked repos
metagent --help                      # Show help
```

## What Gets Installed

```
your-repo/
└── .agents/
    └── code/
        ├── SPEC.md                   # Project specification (generated by bootstrap)
        ├── AGENTS.md                 # Build commands (configured by bootstrap)
        ├── TECHNICAL_STANDARDS.md    # Coding patterns (configured by bootstrap)
        ├── BOOTSTRAP_PROMPT.md       # Setup workflow
        ├── SPEC_PROMPT.md            # Specification phase
        ├── PLANNING_PROMPT.md        # Planning phase
        ├── README.md                 # Workflow docs
        ├── RECOVERY_PROMPT.md        # When things go wrong
        ├── REFRESH_PROMPT.md         # Regenerate stale plans
        ├── scripts/
        │   └── spec.sh               # Task bootstrapper
        └── tasks/                    # Your task directories
```

Plus slash commands in `~/.claude/commands/`:
- `/bootstrap` → Configure workflow for repo
- `/spec` → Start specification phase
- `/plan` → Generate implementation plan

## Workflow

```
1. /bootstrap              # Configure for your project (once)
2. /spec my-feature        # Specify what to build
3. /plan my-feature        # Plan the implementation
4. Build loop              # Execute the plan
```

Build loop:
```bash
while :; do cat .agents/code/tasks/my-feature/PROMPT.md | claude-code; done
```

## Adding New Agents

Create a directory with this structure:

```
metagent/
└── my-agent/
    ├── prompts/        # Generic prompts (synced)
    ├── scripts/        # Generic scripts (synced)
    └── templates/      # Project-specific templates (install only)
```

Then: `metagent install -a my-agent`

## Syncing Updates

When you update prompts in metagent:

```bash
metagent sync --all      # Update all tracked repos
```

Only generic files (prompts/, scripts/) are synced. Project-specific files (SPEC.md, AGENTS.md, TECHNICAL_STANDARDS.md, tasks/) are never overwritten.
